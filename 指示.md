# 拒否チャンネルリスト改修案

## チャンネルリストの評価モードの追加

下記2モードを追加し、挙動をそれぞれ変更する

* 限定モード
  - ボットの発言はリストに含まれるチャンネルのみに許可する
  - チャンネルリストはallowリストとして扱う

* 全体モード
  - ボットはすべてのチャンネルで発言可能とする
  - チャンネルリストはdenyリストとして扱い、リストに含まれるチャンネルでの発言を禁止する

### 実装案

評価モードは下記変数で定義する

* default_behavior
  - allow: 限定モード
  - deny: 全体モード
  - デフォルトは全体モードとする

## 設定の永続化

* チャンネルリストおよび現在の評価モードの保存先はs3とlocalから選択できるようにし、ファイルとして保存する
* 保存先は、環境変数で指定できるようにする
* 保存先は、デフォルトでlocalとする
* 評価モードおよびチャンネルリストは起動時に読み込み、更新時に保存する

## スラッシュコマンドの追加と変更

上記モード設定に伴い、下記コマンドを追加する

* 評価モードを切り替えるコマンドの追加
  - `/sphene mode` コマンドを追加し、モードを切り替える
  - モードは 限定モード と 全体モード の2つから選択可能
  - モード変更時に、現在のモードを表示する
  - discordサーバー管理者のみが実行可能
  - チャンネルリストファイルを再読み込みする

* チャンネル一覧コマンドの改修
  - `/sphene channels` コマンドを修正し、現在のチャンネルリスト、および評価モードを表示する
  - モードに応じて、allowならば「許可チャンネルリスト」、denyならば「拒否チャンネルリスト」として表示する
  - リストは、チャンネル名とチャンネルIDを表示する
  - リストは、最大100件まで表示する
  - リストが100件以上ある場合は、ページネーションを行う

* 現在のチャンネルをリストに追加するコマンドの追加
  - `/sphene addlist` コマンドを追加し、現在のチャンネルをリストに追加する
  - モードに応じて、allowならば「許可チャンネルリスト」、denyならば「拒否チャンネルリスト」として追加する
  - discordサーバー管理者のみが実行可能
  - チャンネルリストファイルを更新し保存する
  - チャンネルリストファイルを再読み込みする

* 現在のチャンネルをリストから削除するコマンドの追加
  - `/sphene removelist` コマンドを追加し、現在のチャンネルをリストから削除する
  - モードに応じて、allowならば「許可チャンネルリスト」、denyならば「拒否チャンネルリスト」として削除する
  - discordサーバー管理者のみが実行可能
  - チャンネルリストファイルを更新し保存する
  - チャンネルリストファイルを再読み込みする

* チャンネルリストをクリアするコマンドの追加
  - `/sphene clearlist` コマンドを追加し、チャンネルリストをクリアする
  - モードに応じて、allowならば「許可チャンネルリスト」、denyならば「拒否チャンネルリスト」としてクリアする
  - チャンネルリストをクリアする際は、確認メッセージを表示する
  - 確認メッセージは、yes/noで応答する
  - yesの場合は、チャンネルリストをクリアする
  - noの場合は、何もしない
  - discordサーバー管理者のみが実行可能
  - チャンネルリストファイルを更新し保存する
  - チャンネルリストファイルを再読み込みする

* チャンネルリストおよび評価モードを上書き保存するコマンド
  - `/sphene updatelist` コマンドを追加し、チャンネルリストと評価モードを上書き保存する
  - 通常は自動保存だが、なんらかの原因で失敗したばあいなど手動で保存する必要がある場合に使用する
  - モードに応じて、allowならば「許可チャンネルリスト」、denyならば「拒否チャンネルリスト」として上書き保存する
  - discordサーバー管理者のみが実行可能
  - チャンネルリストファイルを更新し保存する
  - チャンネルリストファイルを再読み込みする

## テストの追加

それぞれの実装項目に対してテストを追加する
